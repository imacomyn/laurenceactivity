function exportEleves(request, response) {	response.contentType = 'application/vnd.ms-excel';	//response.contentType = 'text/plain';	var vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, vAssoc;	vToday = new Date();	vCoul = "#FFFFFF";	//AnScol = ds.Annees_Scolaires.query("Date_Debut <= :1 and Date_fin >= :1", vToday);	//vAnScol = AnScol[0].ID;	//vLibAn = AnScol[0].Annee_Scolaire;	//if (vAnScol !== null) {		exportData = '<head> <meta charset="UTF-8"> </head> ';		exportData += '<TABLE cellspacing="2px" cellpadding="2px" cellspacing="1px" rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		exportData += "<TR><TD COLSPAN=7 height=50 align=CENTER><B><font size=5 >Liste des élèves présent(e)s </B><BR>"		exportData += "<font size=3 >Export ALT.C - Ateliers Laurence TROTIN - Cartonnage ( "+vToday+" )</TD></TR>";		eleves = ds.Eleves.query("( Utilisateur.Date_Sortie = null or Utilisateur.Date_Sortie > :1 ) order by Nom_Complet",vToday);		exportData += '<TR><TD align=CENTER height=20 width=220 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Nom Prénom</B></TD><TD align=CENTER width=70 bgcolor="#084B8A">';		exportData += '<B><FONT color=#FFFFFF>Sexe</B></TD><TD align=CENTER width=100 bgcolor="#0B0B61"><FONT color=#FFFFFF><B>Fixe</B></TD>';		exportData += '<TD align=CENTER width=100 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Portable</B></TD><TD align=CENTER width=300 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Adresse</B></TD>';		exportData += '<TD align=CENTER width=80 bgcolor="#084B8A"><B><FONT color=#FFFFFF>CP</B></TD><TD align=CENTER width=180 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Ville</B></TD>';		exportData += '<TD align=CENTER width=220 bgcolor="#084B8A"><B><FONT color=#FFFFFF>eMail</B></TD><TD align=CENTER width=250 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Association</B></TD>';		exportData += '</TR>';		eleves.forEach(function (eleve) {			vMail = ((eleve.Utilisateur.eMail === null) ? '-' : eleve.Utilisateur.eMail);			if (eleve.Association == null) {				vAssoc = "-";			} else {				vAssoc = eleve.Association.Nom;			}			if (vMail === null) {				vMail = " ";			}			if (vCoul === "#CEECF5") {				vCoul = "#FFFFFF";			} else {				vCoul = "#CEECF5";			}			exportData +=  '<TR><TD bgcolor="'+vCoul+'">' + eleve.Nom_Complet + '</TD><TD bgcolor="'+vCoul+'" align=CENTER>' + eleve.Sexe + '</TD><TD bgcolor="'+vCoul+'">';			exportData +=  ((eleve.Telephone === null) ? '-' : eleve.Telephone) + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'">' + ((eleve.Portable === null) ? '-' : eleve.Portable) + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + eleve.Adresse_1 + '</TD><TD bgcolor="'+vCoul+'" align=CENTER>' + eleve.CP + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'">' + eleve.Ville + '</TD><TD bgcolor="'+vCoul+'">' + vMail + '</TD><TD bgcolor="'+vCoul+'">' + vAssoc + '</TD></TR>';		});		exportData += '</TABLE>';	//} else {	//	exportData = " ";	//}	return exportData;}function exportInscrits(request, response) {	response.contentType = 'application/vnd.ms-excel';	//response.contentType = 'text/plain';	var vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vCoul, vAssoc, vUser, vUserName, uParam, vQuery, vMail, vAn, vT1, vT2, vT3, vAdh;	vToday = new Date();	vCoul = "#FFFFFF";	vUser = currentUser();    vUserName = vUser.name; 	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName); 	if (uParam[0].Annee_Scolaire == null) {  		vQuery = "-"; 	} else { 		vQuery = "Annee_Scolaire.ID = :1 order by Eleve.Nom_Complet"; 		vLibAn = uParam[0].Annee_Scolaire.Annee_Scolaire; 		vAnScol = uParam[0].Annee_Scolaire.ID; 	}		if (vAnScol !== null) {		exportData = '<head> <meta charset="UTF-8"> </head> ';		exportData += '<TABLE cellspacing="2px" cellpadding="2px" cellspacing="1px" rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		exportData += "<TR><TD COLSPAN=7 height=50 align=CENTER><B><font size=5 >Liste des élèves inscrits pour l'année scolaire " +  vLibAn + "</B><BR>"		exportData += "<font size=3 >Export ALT.C - Ateliers Laurence TROTIN - Cartonnage ( "+vToday+" )</TD></TR>";		eleves = ds.Inscriptions.query(vQuery,vAnScol);		exportData += '<TR><TD align=CENTER height=20 width=220 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Nom Prénom</B></TD><TD align=CENTER width=220 bgcolor="#084B8A">';		exportData += '<B><FONT color=#FFFFFF>eMail</B></TD><TD align=CENTER width=100 bgcolor="#0B0B61"><FONT color=#FFFFFF><B>Année Complète</B></TD>';		exportData += '<TD align=CENTER width=80 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Adhésion</B></TD>';		exportData += '<TD align=CENTER width=220 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Chèque Adhésion</B></TD><TD align=CENTER width=180 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Montant Adhésion</B></TD>';		exportData += '<TD align=CENTER width=80 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Trimestre 1</B></TD>';		exportData += '<TD align=CENTER width=220 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Chèque Trimestre 1</B></TD><TD align=CENTER width=180 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Montant T1</B></TD>';		exportData += '<TD align=CENTER width=80 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Trimestre 2</B></TD>';		exportData += '<TD align=CENTER width=220 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Chèque Trimestre 2</B></TD><TD align=CENTER width=180 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Montant T2</B></TD>';		exportData += '<TD align=CENTER width=80 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Trimestre 3</B></TD>';		exportData += '<TD align=CENTER width=220 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Chèque Trimestre 3</B></TD><TD align=CENTER width=180 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Montant T3</B></TD>';		exportData += '</TR>';		eleves.forEach(function (eleve) {			vMail = ((eleve.Eleve.Utilisateur.eMail === null) ? '-' : eleve.Eleve.Utilisateur.eMail);			vAn = ((eleve.Annee_Complete) ? 'x' : ' ');			vT1 = ((eleve.Trim_1) ? 'x' : ' ');			vT2 = ((eleve.Trim_2) ? 'x' : ' ');			vT3 = ((eleve.Trim_3) ? 'x' : ' ');			vAdh = ((eleve.Adhesion) ? 'x' : ' ');			if (vCoul === "#CEECF5") {				vCoul = "#FFFFFF";			} else {				vCoul = "#CEECF5";			}			exportData +=  '<TR><TD bgcolor="'+vCoul+'">' + eleve.Eleve.Nom_Complet + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + vMail + '</TD><TD bgcolor="'+vCoul+'" align=CENTER >' + vAn + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'" align=CENTER >' + vAdh + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + ((eleve.Cheque_Adh_Num === null) ? '-' : eleve.Cheque_Adh_Num) + '</TD><TD bgcolor="'+vCoul+'" align=RIGHT>' + ((eleve.Cheque_Adh_Montant === null) ? '0' : eleve.Cheque_Adh_Montant) + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'" align=CENTER >' + vT1 + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + ((eleve.Cheque_T1_Num === null) ? '-' : eleve.Cheque_T1_Num) + '</TD><TD bgcolor="'+vCoul+'" align=RIGHTR>' + ((eleve.Cheque_T1_Montant === null) ? '0' : eleve.Cheque_T1_Montant) + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'" align=CENTER >' + vT2 + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + ((eleve.Cheque_T2_Num === null) ? '-' : eleve.Cheque_T2_Num) + '</TD><TD bgcolor="'+vCoul+'" align=RIGHT>' + ((eleve.Cheque_T2_Montant === null) ? '0' : eleve.Cheque_T2_Montant) + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'" align=CENTER >' + vT3 + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + ((eleve.Cheque_T3_Num === null) ? '-' : eleve.Cheque_T3_Num) + '</TD><TD bgcolor="'+vCoul+'" align=RIGHT>' + ((eleve.Cheque_T3_Montant === null) ? '0' : eleve.Cheque_T3_Montant) + '</TD>';			exportData +=  '</TR>';		});		exportData += '</TABLE>';	} else {		exportData = " ";	}	return exportData;}function exportInStages(request, response) {	response.contentType = 'application/vnd.ms-excel';	//response.contentType = 'text/plain';	var vToday, exportData, dNais, dtNais, vSect, vCar, vStaID, AnScol, vLibAn, vCoul, vAssoc, vUser, vUserName, uParam, vQuery, vMail, vAn, 		vT1, vT2, vT3, vAdh, vTot, Nmonth, Nday, Nyear, dTmp, LstJ = ["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"], Lday;	vToday = new Date();	vCoul = "#FFFFFF";	vUser = currentUser();    vUserName = vUser.name; 	uParam = ds.UserParam.query("Utilisateur.Login = :1", vUserName); 	if (uParam[0].Stage == null) {  		vQuery = "-"; 	} else { 		vQuery = "Stage.ID = :1 order by Eleve.Nom_Complet"; 		dTmp = uParam[0].Stage.dDeb; 		Lday = LstJ[dTmp.getDay()]; 		Nday = dTmp.getDate();		Nday = ((Nday < 10) ? '0' : '') + Nday; 		Nmonth = dTmp.getMonth() + 1;		Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 		Nyear = dTmp.getYear();		Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;  		vLibAn = Lday + " " + Nday + '/' + Nmonth + '/' + Nyear + " au "; 		dTmp = uParam[0].Stage.dFin; 		Lday = LstJ[dTmp.getDay()]; 		Nday = dTmp.getDate();		Nday = ((Nday < 10) ? '0' : '') + Nday; 		Nmonth = dTmp.getMonth() + 1;		Nmonth = ((Nmonth < 10) ? '0' : '') + Nmonth; 		Nyear = dTmp.getYear();		Nyear = ((Nyear < 200) ? 1900 : 0) + Nyear;  		vLibAn += Lday + " " + Nday + '/' + Nmonth + '/' + Nyear;  		vStaID = uParam[0].Stage.ID; 	}		if (vStaID !== null) {		vTot = 0;		exportData = '<head> <meta charset="UTF-8"> </head> ';		exportData += '<TABLE cellspacing="2px" cellpadding="2px" cellspacing="1px" rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		exportData += "<TR><TD COLSPAN=7 height=50 align=CENTER><B><font size=5 >Liste des élèves en stage du " +  vLibAn + "</B><BR>"		exportData += "<font size=3 >Export ALT.C - Ateliers Laurence TROTIN - Cartonnage ( "+vToday+" )</TD></TR>";		eleves = ds.InsStage.query(vQuery,vStaID);		exportData += '<TR><TD align=CENTER height=20 width=220 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Nom Prénom</B></TD><TD align=CENTER width=220 bgcolor="#084B8A"><B><FONT color=#FFFFFF>eMail</B></TD>';		exportData += '<TD align=CENTER width=80 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Adhésion</B></TD>';		exportData += '<TD align=CENTER width=220 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Chèque Stage</B></TD><TD align=CENTER width=180 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Montant</B></TD>';		exportData += '</TR>';		eleves.forEach(function (eleve) {			vMail = ((eleve.Eleve.Utilisateur.eMail === null) ? '-' : eleve.Eleve.Utilisateur.eMail);			vAdh = ((eleve.Adhesion) ? 'x' : ' ');			if (vCoul === "#CEECF5") {				vCoul = "#FFFFFF";			} else {				vCoul = "#CEECF5";			}			exportData +=  '<TR><TD bgcolor="'+vCoul+'">' + eleve.Eleve.Nom_Complet + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + vMail + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'" align=CENTER >' + vAdh + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + ((eleve.Cheque_Num === null) ? '-' : eleve.Cheque_Num) + '</TD><TD bgcolor="'+vCoul+'" align=RIGHT>' + ((eleve.Cheque_Mon === null) ? '0' : eleve.Cheque_Mon) + '</TD>';			exportData +=  '</TR>';			if (eleve.Cheque_Mon !== null) {				vTot += eleve.Cheque_Mon;			}		});		if (vCoul === "#CEECF5") {			vCoul = "#FFFFFF";		} else {			vCoul = "#CEECF5";		}		exportData +=  '<TR><TD COLSPAN=4 bgcolor="'+vCoul+'" align=RIGHT ><B>Total</B></TD><TD bgcolor="'+vCoul+'" align=RIGHT ><B>' + vTot + '</B></TD></TR>';		exportData += '</TABLE>';	} else {		exportData = " ";	}	return exportData;}