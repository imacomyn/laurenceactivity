function exportEleves(request, response) {	response.contentType = 'application/vnd.ms-excel';	//response.contentType = 'text/plain';	var vToday, exportData, dNais, dtNais, vSect, vCar, vAnScol, AnScol, vLibAn, vMail, Nday, Nmonth, Nyear, vCoul, vAssoc;	vToday = new Date();	vCoul = "#FFFFFF";	//AnScol = ds.Annees_Scolaires.query("Date_Debut <= :1 and Date_fin >= :1", vToday);	//vAnScol = AnScol[0].ID;	//vLibAn = AnScol[0].Annee_Scolaire;	//if (vAnScol !== null) {		exportData = '<head> <meta charset="UTF-8"> </head> ';		exportData += '<TABLE cellspacing="2px" cellpadding="2px" cellspacing="1px" rules="all" style="border:solid 2px black; font-family:Calibri; font-size:12px; vertical-align: middle;">';		exportData += "<TR><TD COLSPAN=7 height=50 align=CENTER><B><font size=5 >Liste des élèves présent(e)s </B><BR>"		exportData += "<font size=3 >Export ALT.C - Ateliers Laurence TROTIN - Cartonnage ( "+vToday+" )</TD></TR>";		eleves = ds.Eleves.query("( Utilisateur.Date_Sortie = null or Utilisateur.Date_Sortie > :1 ) order by Nom_Complet",vToday);		exportData += '<TR><TD align=CENTER height=20 width=220 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Nom Prénom</B></TD><TD align=CENTER width=70 bgcolor="#084B8A">';		exportData += '<B><FONT color=#FFFFFF>Sexe</B></TD><TD align=CENTER width=100 bgcolor="#0B0B61"><FONT color=#FFFFFF><B>Fixe</B></TD>';		exportData += '<TD align=CENTER width=100 bgcolor="#084B8A"><B><FONT color=#FFFFFF>Portable</B></TD><TD align=CENTER width=300 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Adresse</B></TD>';		exportData += '<TD align=CENTER width=80 bgcolor="#084B8A"><B><FONT color=#FFFFFF>CP</B></TD><TD align=CENTER width=180 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Ville</B></TD>';		exportData += '<TD align=CENTER width=220 bgcolor="#084B8A"><B><FONT color=#FFFFFF>eMail</B></TD><TD align=CENTER width=250 bgcolor="#0B0B61"><B><FONT color=#FFFFFF>Association</B></TD>';		exportData += '</TR>';		eleves.forEach(function (eleve) {			vMail = ((eleve.Utilisateur.eMail === null) ? '-' : eleve.Utilisateur.eMail);			if (eleve.Association == null) {				vAssoc = "-";			} else {				vAssoc = eleve.Association.Nom;			}			if (vMail === null) {				vMail = " ";			}			if (vCoul === "#CEECF5") {				vCoul = "#FFFFFF";			} else {				vCoul = "#CEECF5";			}			exportData +=  '<TR><TD bgcolor="'+vCoul+'">' + eleve.Nom_Complet + '</TD><TD bgcolor="'+vCoul+'" align=CENTER>' + eleve.Sexe + '</TD><TD bgcolor="'+vCoul+'">';			exportData +=  ((eleve.Telephone === null) ? '-' : eleve.Telephone) + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'">' + ((eleve.Portable === null) ? '-' : eleve.Portable) + '</TD><TD bgcolor="'+vCoul+'" align=LEFT>' + eleve.Adresse_1 + '</TD><TD bgcolor="'+vCoul+'" align=CENTER>' + eleve.CP + '</TD>';			exportData +=  '<TD bgcolor="'+vCoul+'">' + eleve.Ville + '</TD><TD bgcolor="'+vCoul+'">' + vMail + '</TD><TD bgcolor="'+vCoul+'">' + vAssoc + '</TD></TR>';		});		exportData += '</TABLE>';	//} else {	//	exportData = " ";	//}	return exportData;}